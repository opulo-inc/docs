
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Flash Marlin onto the motherboard.
">
      
      
      
        <link rel="canonical" href="https://docs.opulo.io/byop/motherboard/update-firmware/">
      
      <link rel="icon" href="../../../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Update the Firmware - Opulo Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#using-the-auto-build-marlin-vscode-extension" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Opulo Documentation" class="md-header__button md-logo" aria-label="Opulo Documentation" data-md-component="logo">
      
  <img src="../../../img/opulo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Opulo Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Update the Firmware
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/opulo-inc/documentation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Opulo Documentation" class="md-nav__button md-logo" aria-label="Opulo Documentation" data-md-component="logo">
      
  <img src="../../../img/opulo.png" alt="logo">

    </a>
    Opulo Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/opulo-inc/documentation/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Semi Assembly
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Semi Assembly" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Semi Assembly
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../semi-assembly/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../semi-assembly/unboxing/" class="md-nav__link">
        Unboxing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../semi-assembly/assembling-frame/" class="md-nav__link">
        Assembling the Frame
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../semi-assembly/mounting-staging-plates/" class="md-nav__link">
        Mounting Staging Plates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../semi-assembly/wiring/" class="md-nav__link">
        Wiring
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Kit Assembly
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kit Assembly" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Kit Assembly
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanical-assembly/printing-parts/" class="md-nav__link">
        Printing Parts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanical-assembly/belt-tensioners/" class="md-nav__link">
        Belt Tensioners
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanical-assembly/left-side/" class="md-nav__link">
        Left Side
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanical-assembly/right-side/" class="md-nav__link">
        Right Side
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanical-assembly/connecting-sides/" class="md-nav__link">
        Connecting the Sides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanical-assembly/y-gantry-assembly/" class="md-nav__link">
        Y Gantry Assembly
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../mechanical-assembly/x-gantry-assembly/" class="md-nav__link">
        X Gantry Assembly
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          OpenPnP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OpenPnP" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          OpenPnP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Calibration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Calibration" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Calibration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/import-config/" class="md-nav__link">
        Importing Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/connect-to-machine/" class="md-nav__link">
        Connecting to Your Machine
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/camera-fisheye-cal/" class="md-nav__link">
        Camera Fisheye
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/homing-fiducial/" class="md-nav__link">
        Homing Fiducial
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/mm-per-pixel/" class="md-nav__link">
        MM/Pixel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/nozzle-offset/" class="md-nav__link">
        Nozzle Offset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/bottom-camera-position/" class="md-nav__link">
        Bottom Camera Position
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/backlash-compensation/" class="md-nav__link">
        Backlash Compensation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/calibration/auto-toolchanger/" class="md-nav__link">
        Automatic Toolchanger
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4_3">
          Running Your First Job
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Running Your First Job" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          Running Your First Job
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/ftp/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/ftp/installing-the-feeders/" class="md-nav__link">
        Installing Feeders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/ftp/setting-up-the-board/" class="md-nav__link">
        Setting Up the Board
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../openpnp/next-steps/" class="md-nav__link">
        Next Steps
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Misc
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Misc" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Misc
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_1">
          Troubleshooting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Troubleshooting" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Troubleshooting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/troubleshooting/symptoms/" class="md-nav__link">
        Symptoms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/troubleshooting/solutions/" class="md-nav__link">
        Solutions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/troubleshooting/diagnostic-routines/" class="md-nav__link">
        Diagnostic Routines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/troubleshooting/vision-pipeline-adjustment/" class="md-nav__link">
        Vision Pipeline Adjustment
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5_2">
          Maintentance and Upgrades
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Maintentance and Upgrades" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Maintentance and Upgrades
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../misc/maintenance-upgrades/rev3-vac-interposer/" class="md-nav__link">
        REV03 Mobo Interposer Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#using-the-auto-build-marlin-vscode-extension" class="md-nav__link">
    Using the Auto Build Marlin VSCode Extension
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#manually-configuring-platformio-for-flashing-via-pio" class="md-nav__link">
    Manually Configuring PlatformIO (for flashing via PIO)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashing-factory-firmware" class="md-nav__link">
    Flashing Factory Firmware
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
    <nav class="md-nav" aria-label="Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#alternative-method-not-recommended" class="md-nav__link">
    Alternative Method (Not Recommended)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    Next steps
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/opulo-inc/documentation/edit/master/docs/byop/motherboard/update-firmware/index.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


  <h1>Update the Firmware</h1>

<!-- markdownlint-disable MD034 -->
<!-- (To change the targeted Marlin version, change it in the YAML above. That'll change the links too.) -->
<!-- (Links that are used in multiple places are here. Change if necessary:) -->
<p>[latest_marlin]: https://github.com/MarlinFirmware/Marlin/archive/refs/heads/{{&lt; param marlin-version &gt;}}.zip
[latest_marlin_config]: https://raw.githubusercontent.com/MarlinFirmware/Configurations/{{&lt; param marlin-version &gt;}}/config/examples/Opulo/Lumen_REV3/Configuration.h
[latest_marlin_adv_config]: https://raw.githubusercontent.com/MarlinFirmware/Configurations/{{&lt; param marlin-version &gt;}}/config/examples/Opulo/Lumen_REV3/Configuration_adv.h</p>
<p><strong>This step is optional.</strong> Your motherboard comes with a correct build of Marlin pre-installed, but if you'd like to update the firmware or change settings, this will help you do so!</p>
<h2 id="using-the-auto-build-marlin-vscode-extension">Using the Auto Build Marlin VSCode Extension</h2>
<p>{{% alert color="info" title="MARLIN VERSION" %}}
 The currently linked-to Marlin version is <code>{{&lt; param marlin-version &gt;}}</code>. Building an older version of Marlin with the recommended config files won't work. If you are unsure whether a previously-downloaded local version of Marlin is the newest one, re-downloading it is the safest choice.
 {{% /alert %}}</p>
<ol>
<li>Download the [latest Marlin firmware][latest_marlin] and unzip it.</li>
<li>Install <a href="https://code.visualstudio.com/">VSCode</a> and its <a href="https://marketplace.visualstudio.com/items?itemName=platformio.platformio-ide">PlatformIO extension</a>.</li>
<li>Open Marlin firmware's folder on VSCode.</li>
<li>Grab Marlin configuration files ([Configuration.h][latest_marlin_config] and [Configuration_adv.h][latest_marlin_adv_config]) and replace the files in the Marlin/Marlin folder with those new ones.</li>
<li>Install the Auto Build Marlin plugin using this <a href="https://marlinfw.org/docs/basics/auto_build_marlin.html">Marlin Documentation page</a>, or download it directly from the <a href="https://marketplace.visualstudio.com/items?itemName=MarlinFirmware.auto-build">Visual Studio Marketplace</a>.</li>
<li>
<p>Try to build Marlin using the build button with the hammer icon as shown below:
![](images/marlin-auto-build-ui.PNG" alt="Marlin auto-build UI" &gt;}}</p>
</li>
<li>
<p>If this is successful, attach the LumenPnP Mobo to your computer with the USB cable. If it isn't, this might help:</p>
<ul>
<li>Check the error messages for configuration errors and fix them, or replace it with the default config</li>
<li>If this fails, check that your config file version is the same as your Marlin version (e.g. a bugfix-2.0.x config file won't work in a bugfix-2.1.x)</li>
<li>When in doubt, re-download Marlin and the configuration files from the links above</li>
</ul>
</li>
<li>
<p>Boot your motherboard into DFU Mode</p>
<ol>
<li>Press and hold the <code>BOOT</code> button</li>
<li>Press the Reset button and hold for 10 seconds</li>
<li>Release the Reset button and wait for 10 seconds</li>
<li>Release the <code>BOOT</code> button
  ![](images/IMG_0749.JPG" alt="BOOT and RESET buttons" &gt;}}</li>
</ol>
</li>
</ol>
<p>{{% alert color="info" title="NOTE" %}}
If you have a hard time getting your board to enter DFU mode, instead try powering off the machine entirely, holding the 'BOOT' button, plugging in power, waiting 10 seconds, then release the <code>BOOT</code> button.
{{% /alert %}}</p>
<ol>
<li>Flash the Motherboard using <code>dfu-util</code> by running the command <code>dfu-util -d 0x0483:0xdf11 -s 0x08000000:leave -a 0 -D ./.pio/build/Opulo_Lumen_REV3/firmware.bin</code> in the integrated terminal in the root of the repository.  ![](images/vscode-dfu-util-integrated-terminal.png" alt="integrated terminal in VSCode with DFU-Util command" &gt;}}</li>
</ol>
<p>{{% alert color="info" title="COMMAND EXPLANATION" %}}
<code>dfu-util</code> is a flash tool available on all platforms.</p>
<ul>
<li><code>-d 0x0483:0x0df11</code> tells the tool to flash the STM32 chip on the motherboard. This is optional if you only have one dfu device connected.</li>
<li><code>-s 0x8000000:leave</code> is the target memory address that the firmware is flashed to. The <code>:leave</code> part will cause the chip to reset on its own, making the machine accessible in OpenPNP without rebooting it.</li>
<li><code>-a 0</code> makes the tool use the alt setting required for flashing the ESP32.</li>
<li>
<p><code>-D ./.pio/build/Opulo_Lumen_REV3/firmware.bin</code> is the path to the to-be-flashed firmware. If you want to flash another file, change this.
{{% /alert %}}</p>
</li>
<li>
<p>Wait for the process to finish.</p>
</li>
<li>
<p>The machine should show up as a COM/Serial Port on your PC now, and you should be able to access it via OpenPNP. If it doesn't, press the Reset button on the board, or power-cycle the machine <em>after the flashing is completed</em>.</p>
</li>
</ul>
<blockquote>
<p>This is how you can check whether your machine is connected properly:</p>
<ul>
<li>Windows:
  ![](images/STM32_COM_port_connected.png" alt="STM32 shows up as a COM/Serial Port" &gt;}}</li>
<li>Mac/Linux:
  ![](images/linux_lsusb.png" alt="STM32 shows up on lsusb" &gt;}}</li>
</ul>
</blockquote>
<p>{{% alert color="info" title="FLASHING VIA PLATFORMIO" %}}
Note that flashing the firmware using the Auto Build Marlin Plugin might work, but seems error-prone for most people. Therefore, if you want to try it, you can, but using <code>dfu-util</code> is generally a better idea.
If you're absolutely sure that ABM is the way to go, do this:</p>
<ol>
<li>Boot your motherboard into DFU Mode</li>
<li>Press and hold the <code>BOOT</code> button</li>
<li>Press the Reset button and hold for 10 seconds</li>
<li>Release the Reset button and wait for 10 seconds</li>
<li>Release the <code>BOOT</code> button
 ![](images/IMG_0749.JPG" alt="BOOT and RESET buttons" &gt;}}</li>
<li>Now, press the upload button in ABM as shown below:
![](images/marlin-auto-build-ui.PNG" alt="Marlin auto-build UI" &gt;}}</li>
<li>Wait for the process to finish</li>
<li>Continue with step 11
{{% /alert %}}</li>
</ol>
<h2 id="manually-configuring-platformio-for-flashing-via-pio">Manually Configuring PlatformIO (for flashing via PIO)</h2>
<ol>
<li>Download the [latest Marlin firmware][latest_marlin] and unzip it.</li>
<li>Install <a href="https://code.visualstudio.com/">VSCode</a> and its <a href="https://marketplace.visualstudio.com/items?itemName=platformio.platformio-ide">PlatformIO extension</a></li>
<li>Open Marlin firmware's folder on VSCode</li>
<li>
<p>Grab Marlin configuration files ([Configuration.h][latest_marlin_config] and [Configuration_adv.h][latest_marlin_adv_config]) and replace the files in the Marlin/Marlin folder with those new ones.</p>
</li>
<li>
<p>Edit the platformio.ini file to indicate which board you're uploading to. Update <code>default_envs</code> to read <code>Opulo_Lumen_REV3</code> or <code>Opulo_Lumen_REV4</code> depending on your motherboard.
  ![](images/Screen Shot 2022-02-04 at 7.27.25 PM.PNG" alt="BOOT and RESET buttons" &gt;}}</p>
</li>
<li>
<p>Attach the LumenPnP Mobo to your computer with the USB cable.</p>
</li>
<li>
<p>Boot your motherboard into DFU Mode</p>
<ol>
<li>Press and hold the <code>BOOT</code> button</li>
<li>Press the Reset button and hold for 10 seconds</li>
<li>Release the Reset button and wait for 10 seconds</li>
<li>Release the <code>BOOT</code> button
  ![](images/IMG_0749.JPG" alt="BOOT and RESET buttons" &gt;}}</li>
</ol>
</li>
</ol>
<p>{{% alert color="info" title="NOTE" %}}
If you have a hard time getting your board to enter DFU mode, instead try powering off the machine entirely, holding the 'BOOT' button, plugging in power, waiting 10 seconds, then release the <code>BOOT</code> button.
{{% /alert %}}</p>
<ol>
<li>
<p>Upload firmware to the board via PlatformIO:
  ![](images/vscode_marlin_env.png" alt="Upload firmware via PIO" &gt;}}</p>
</li>
<li>
<p>Wait for the process to finish:
  ![](images/PIO_upload_done.png" alt="PIO firmware upload done" &gt;}}</p>
</li>
<li>
<p>Press Reset on the board, or power-cycle the machine <em>after the flashing is completed</em>. Now it should show up as a COM/Serial Port on your PC:</p>
</li>
<li>
<p>Windows:
  ![](images/STM32_COM_port_connected.png" alt="STM32 shows up as a COM/Serial Port" &gt;}}</p>
</li>
<li>Mac/Linux:
  ![](images/linux_lsusb.png" alt="STM32 shows up on lsusb" &gt;}}</li>
</ol>
<h2 id="flashing-factory-firmware">Flashing Factory Firmware</h2>
<p>If you've put new firmware on your motherboard, but just want to get back to the firmware that your machine was flashed with, check the release for your build number and download the .bin firmware file attached to it. Put your board into DFU mode as described above, connect to your computer, and flash the binary to the board using the following command:</p>
<pre><code class="language-shell">`dfu-util -d 0x0483:0xdf11 -s 0x08000000:leave -a 0 -D ~/path/to/firmware.bin`
</code></pre>
<p>Once flashing is completed, the machine should automatically exit DFU mode, and be accessible to OpenPNP again. For more information see <a href="#using-the-auto-build-marlin-vscode-extension">Step 9 of the update firmware guide</a>.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<p>If you aren't able to upload, you can check to see if your motherboard is booting into DFU mode correctly:</p>
<ul>
<li>
<p>Windows:
  ![](images/dfu_mode_device_manager.png" alt="STM32 in DFU mode in Device Manager" &gt;}}</p>
</li>
<li>
<p>Mac/Linux:
  ![](images/linux_lsusb_bootloader.png" alt="STM32 in DFU mode in lsusb" &gt;}}</p>
</li>
</ul>
<p>Also, reference <a href="https://marlinfw.org/docs/basics/install_platformio.html">the Marlin instructions for uploading</a>. Be sure to use <code>{{&lt; param marlin-version &gt;}}</code> if uploading using these instructions.</p>
<h3 id="alternative-method-not-recommended">Alternative Method (Not Recommended)</h3>
<p>This method requires an ST-Link (V2 Clone or equivalent). Additionally you need the software  <a href="https://www.st.com/en/development-tools/stm32cubeprog.html">STM32CubeProgrammer</a> by ST. This method is a bit more involved and takes longer than just using the DFU mode.</p>
<ol>
<li>Compile (build) the project normally with PIO</li>
<li>This generates a .bin-file that contains the firmware</li>
<li>Connect your board to your ST-Link through the SWD header on board</li>
<li>Start STM32CubeProgrammer</li>
<li>
<p>Connect to the MCU:
  ![](images/connect_STM_to_programmer.png" alt="Connecting to the STM programmer" &gt;}}</p>
</li>
<li>
<p>Click on <strong>Open file</strong> and navigate to the <strong>firmware.bin</strong> file in <em>PROJECT_DIRECTORY/.pio/build/STM32F407VE_black</em>
  ![](images/open_firmware_bin_file.png" alt="Opening the compiled firmware file" &gt;}}</p>
</li>
<li>
<p>Click on <strong>Download</strong>. This will flash the SMT32F4 with the provided firmware
  <img alt="" src="images/start_firmware_download.png&quot; alt=&quot;Downloading (flashing) the firmware&quot; &gt;" />}</p>
</li>
<li>
<p>Done! Now you just have to disconnect the ST-Link and press the reset button on the board.</p>
</li>
</ol>
<h2 id="next-steps">Next steps</h2>
<p>Continue to <a href="{{&lt; relref &quot;wiring-and-pneumatics&quot; &gt;}}">wiring and pneumatics</a>.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
    
    
  </body>
</html>